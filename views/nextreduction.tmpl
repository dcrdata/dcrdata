{{define "nextreduction"}}
{{$conv := .Conversions}}
<!DOCTYPE html>
<html lang="en">
{{ template "html-head" "Decred Block Explorer by dcrdata.org"}}
    {{ template "navbar" . }}
    <div class="container main" 
    data-controller="nextreduction" data-nextreduction-remaining-seconds="{{getRewardWindowRemainingTime .Info.IdxInRewardWindow .Info.Params.RewardWindowSize .Info.Params.BlockTime}}">
        <div class="row">
            <div class="d-flex flex-column col-md-24 p-0 custom-next-reduction">
                <div class="py-1 px-2 mb-1 bg-white flex-grow-1">
                    <div class="my-3 h4 mb-3 text-center">
                        <span class="dcricon-pickaxe d-inline-block pr-2 h3 title"></span>
                        <span>Next Block Reward Reduction</span>
                    </div>
                     <div class="row mt-1 reduction-block-warpper">
                        <div class="col-8 col-lg-5 col-md-5 col-sm-8 mb-3 mb-sm-2 mb-md-3 mb-lg-3 reduction-block-inner">
                            <div class="fs13 text-secondary">
                                Current Block
                            </div>
                            <div class="mono lh1rem fs14-decimal fs24 pt-1 pb-1 d-flex align-items-baseline">
                                <div class="mtb-0-lr-auto">
                                 <a class="d-inline-block h3 position-relative" href="/block/{{.BestBlock.Hash}}" data-target="nextreduction.blockHeight">{{.BestBlock.Height}}</a>
                                </div>
                            </div>
                        </div>
                        <div class="reward-reduction-block col-8 col-lg-6 col-md-6 col-sm-8 mb-3 mb-sm-2 mb-md-3 mb-lg-3">
                           {{$idxInRewardWindowInt64Parse := int64 .Info.IdxInRewardWindow}}
                           {{$remainingBlocksTillReduction := subtract .Info.Params.RewardWindowSize $idxInRewardWindowInt64Parse}}
                           {{$nextRewardReductionBlockHeight := add .BestBlock.Height $remainingBlocksTillReduction}}
                            <div class="fs13 text-secondary">
                                Next Reward Reduction Block
                            </div>
                            <div class="mono lh1rem fs14-decimal fs24 pt-1 pb-1 d-flex align-items-baseline">
                                <div class="mtb-0-lr-auto">
                                <a href="javascript:void(0)" data-target="nextreduction.nextRewardReductionBlockHeight" data-next-reduction-block="{{$nextRewardReductionBlockHeight}}" class="h3">{{$nextRewardReductionBlockHeight}}</a>
                                </div>
                            </div>
                        </div>
                        <div class="reward-reduction-block col-8 col-lg-8 col-md-8 col-sm-8 mb-3 mb-sm-2 mb-md-3 mb-lg-3">
                            <div class="fs13 text-secondary">
                                Number of Blocks Remaining till Reduction
                            </div>
                            <div class="mono lh1rem fs14-decimal fs24 pt-1 pb-1 d-flex align-items-baseline">
                                <div  class="mtb-0-lr-auto"><a href="javascript:void(0)" class="h3" data-target="nextreduction.remainingBlocksTillReduction">{{$remainingBlocksTillReduction}}</a></div>
                            </div>
                        </div>
                        </div>
                        <div class="row mt-1 reward-reduction-block">
                        <div class="col-24 mb-3 mb-sm-2 mb-md-3 mb-lg-3 reward-reduction-block">
                            <div class="fs12 lh1rem mt-md-3 mt-lg-3 mt-sm-1 text-center mb-3">
                                <span class="text-black-50 timer reward-reduction-block-timer" data-target="nextreduction.nextReductionTimer">
                                    {{remaining .Info.IdxInRewardWindow .Info.Params.RewardWindowSize .Info.Params.BlockTime}}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>  
            </div>
  {{with .Info}}
            <div class="d-flex flex-column col-md-24 p-0">
                <div class="bg-white mb-1 py-2 px-3">
                    <div class="row mt-1 botom-links-warpper">

                        <div class="col-12 col-lg-8 col-md-8 col-sm-8 mb-3 mb-sm-2 mb-md-3 mb-lg-3">
                            <div class="fs13 text-secondary">PoW Reward</div>
                            <div class="mono lh1rem p03rem0 fs14-decimal fs24 p03rem0 d-flex align-items-baseline">
                                <span data-target="nextreduction.bsubsidyPow">{{template "decimalParts" (float64AsDecimalParts (toFloat64Amount .NBlockSubsidy.PoW) 8 true 2)}}</span>
                                <span class="pl-1 unit lh15rem">DCR</span>
                            </div>
                            {{if $conv}}
                            <div class="fs12 lh1rem text-black-50">
                                <span data-target="nextreduction.powConverted">{{$conv.PowSplit.TwoDecimals}} {{$conv.PowSplit.Index}}</span>
                            </div>
                            {{end}}
                            <div class="fs13 text-secondary mt-2"><a href="/charts?chart=hashrate">Hashrate</a></div>
                            <div class="mono lh1rem pt-1 pb-1 fs14-decimal fs24 d-flex align-items-baseline">
                                <span data-target="nextreduction.hashrate">{{template "decimalParts" (float64AsDecimalParts .HashRate 8 true 2)}}</span>
                                <span class="pl-1 unit lh15rem">Ph/s</span>
                            </div>
                            <div class="fs12 text-black-50 lh1rem text-black-50">
                                <span data-target="nextreduction.hashrateDelta">{{template "fmtPercentage" .HashRateChangeMonth}}</span> in past 30 days
                            </div>
                        </div> 
                        <div class="col-12 col-lg-8 col-md-8 col-sm-8 mb-3 mb-sm-2 mb-md-3 mb-lg-3">
                          <div class="fs13 text-secondary vote-reward-wrapper">Vote Reward</div>
                            <div class="mono lh1rem fs14-decimal fs24 pt-1 pb-1 d-flex align-items-baseline">
                                <span data-target="nextreduction.bsubsidyPos">
                                    {{template "decimalParts" (float64AsDecimalParts (toFloat64Amount (divide .NBlockSubsidy.PoS 5)) 8 true 2)}}
                                </span>
                                <span class="pl-1 unit lh15rem">DCR/vote</span>
                            </div>
                            <div class="fs12 lh1rem text-black-50">
                                <span data-target="nextreduction.ticketReward">{{printf "%.2f" .TicketReward}}%</span> per ~{{.RewardPeriod}}
                            </div>
                            <div class="fs12 lh1rem text-black-50" title="Annual Stake Rewards">{{printf "%.2f" .ASR}}% per year</div>
                            <div class="fs13 text-secondary mt-2"><a href="/charts?chart=stake-participation">Total Staked DCR</a></div>
                            <div class="mono lh1rem fs14-decimal fs24 pt-1 pb-1 d-flex align-items-baseline">
                                <span data-target="nextreduction.poolValue">
                                    {{template "decimalParts" (float64AsDecimalParts .PoolInfo.Value 0 true)}}
                                </span>
                                <span class="pl-1 unit lh15rem">DCR</span>
                            </div>
                            <div class="fs12 lh1rem text-black-50">
                                <span data-target="nextreduction.poolSizePct">{{printf "%.2f" .PoolInfo.Percentage}}</span> % of circulating supply
                            </div>
                        </div>
                        <div class="col-12 col-lg-8 col-md-8 col-sm-8 mb-3 mb-sm-2 mb-md-3 mb-lg-3">
                            <div class="fs13 text-secondary">Treasury Block Reward</div>
                            <div class="mono lh1rem fs14-decimal fs24 p03rem0 d-flex align-items-baseline">
                                <span data-target="nextreduction.bsubsidyDev">
                                    {{template "decimalParts" (float64AsDecimalParts (toFloat64Amount .NBlockSubsidy.Dev) 8 true 2)}}
                                </span>
                                <span class="pl-1 unit lh15rem">DCR</span>
                            </div>
                            {{if $conv}}
                            <div class="fs12 lh1rem text-black-50">
                                <span data-target="nextreduction.convertedDevSub">{{$conv.TreasurySplit.TwoDecimals}} {{$conv.TreasurySplit.Index}}</span>
                            </div>
                            {{end}}
                            {{if .DevFund}}
                                <div class="next-reduction-treasury-d-xm-none mb-3 mb-sm-2 mt-2 mb-md-3 mb-lg-3">
                                    <div class="fs13 text-secondary"><a href="/address/{{.DevAddress}}?n=20&start=0&txntype=merged_debit">Treasury</a></div>
                                    <div class="mono lh1rem fs14-decimal fs24 p03rem0 d-flex align-items-baseline">
                                        <span data-target="nextreduction.devFund">
                                            {{template "decimalParts" (float64AsDecimalParts (toFloat64Amount .DevFund) 0 true)}}
                                        </span>
                                        <span class="pl-1 unit lh15rem">DCR</span>
                                    </div>
                                    {{if $conv}}
                                    <div class="fs12 lh1rem text-black-50">
                                        <span data-target="nextreduction.convertedDev">{{threeSigFigs $conv.TreasuryBalance.Value}} {{$conv.TreasuryBalance.Index}}</span>
                                    </div>
                                    {{end}}
                                </div>
                            {{end}}
                        </div>
                        <div class="d-md-none d-lg-none d-sm-none col-12 col-lg-8 col-md-8 col-sm-8 mb-3 mb-sm-2 mb-md-3 mb-lg-3">
                             {{if .DevFund}}
                                <div class="mb-3 mb-sm-2 mt-2 mb-md-3 mb-lg-3">
                                    <div class="fs13 text-secondary"><a href="/address/{{.DevAddress}}?n=20&start=0&txntype=merged_debit">Treasury</a></div>
                                    <div class="mono lh1rem fs14-decimal fs24 p03rem0 d-flex align-items-baseline">
                                        <span data-target="nextreduction.devFund">
                                            {{template "decimalParts" (float64AsDecimalParts (toFloat64Amount .DevFund) 0 true)}}
                                        </span>
                                        <span class="pl-1 unit lh15rem">DCR</span>
                                    </div>
                                    {{if $conv}}
                                    <div class="fs12 lh1rem text-black-50">
                                        <span data-target="nextreduction.convertedDev">{{threeSigFigs $conv.TreasuryBalance.Value}} {{$conv.TreasuryBalance.Index}}</span>
                                    </div>
                                    {{end}}
                                </div>
                            {{end}}               
                        </div>
                    </div>
                </div>
            </div>
        <div class="d-flex flex-column col-md-24 p-0">
            <div class="bg-white mb-1 py-2 px-3">
                <div class="row mt-1">
                    <div  class="mtb-0-lr-auto">
                       <span>Read more:</span> <a
                        class="text-nowrap pr-1"
                        href="https://docs.decred.org/glossary/#block-reward"
                        title="Block Reward"
                        target="_blank"
                        rel="noopener noreferrer"
                        >Block Reward</a>
                        <span class="pr-1 text-secondary">|</span>
                        <a
                        class="text-nowrap pr-1"
                        href="https://docs.decred.org/advanced/issuance/"
                        title="Issuance"
                        target="_blank"
                        rel="noopener noreferrer"
                        >Issuance</a>
                    </div>
                </div>
            </div>
        </dv>
    {{end}}
    </div>
    </div>
    {{  template "footer" . }}
</body>
</html>
{{end}}
